// Originally generated by the template in CodeDAO
package kotlinadventofcode.`2023`

import com.github.h0tk3y.betterParse.combinators.*
import com.github.h0tk3y.betterParse.grammar.*
import com.github.h0tk3y.betterParse.lexer.*
import kotlinadventofcode.Day
import kotlinx.coroutines.async
import kotlinx.coroutines.runBlocking
import java.math.BigInteger

class `2023-12` : Day {

    override fun runPartOneNoUI(input: String): String {
        return run(input.toRows())
    }

    override fun runPartTwoNoUI(input: String): String {
        return run(input.toRows().map { it.unfolded })
    }

    private fun run(rows: List<Row>): String = runBlocking {
        rows.map { async { it.numValidArrangements } }.sumOf { it.await() }.toString()
    }

    enum class Condition {
        UNKNOWN, DAMAGED, OPERATIONAL;
    }

    data class Row(val conditions: List<Condition>, val damaged: List<Int>) {
        private val numDamaged by lazy { damaged.sum() }
        val numDamagedToPlace by lazy { numDamaged - conditions.count { it == Condition.DAMAGED } }
        val numOperationalToPlace by lazy { conditions.count { it == Condition.UNKNOWN } - numDamagedToPlace }
        val unfolded by lazy {
            Row(
                List(4) { conditions + Condition.UNKNOWN }.flatten() + conditions,
                List(5) { damaged }.flatten()
            )
        }

        val numValidArrangements by lazy {
            getNumValidArrangements(this)
        }

        val isValid by lazy { isRowValid() }
        private fun isRowValid(): Boolean {
            var damagedLength = 0
            var damagedIndex = 0
            for (i in conditions.indices) {
                if (conditions[i] == Condition.UNKNOWN) error("not expecting unknown")
                if (conditions[i] == Condition.DAMAGED) damagedLength++
                if (conditions[i] == Condition.OPERATIONAL && damagedLength > 0) {
                    if (damagedIndex >= damaged.size) return false
                    if (damaged[damagedIndex] != damagedLength) return false
                    damagedLength = 0
                    damagedIndex++
                }
            }

            if (damagedLength == 0 && damagedIndex == damaged.size) return true
            return damagedLength > 0 && damagedIndex == damaged.size - 1 && damaged[damagedIndex] == damagedLength
        }

        companion object {
            private val numValidArrangementsByRow = mutableMapOf<Row, BigInteger>()
            private fun getNumValidArrangements(row: Row): BigInteger {
                if (row.numDamagedToPlace < 0) return BigInteger.ZERO
                if (row.numOperationalToPlace < 0) return BigInteger.ZERO
                if (row.numDamagedToPlace == 0) {
                    val newRow = Row(
                        row.conditions.map { if (it == Condition.UNKNOWN) Condition.OPERATIONAL else it },
                        row.damaged)

                    return if (newRow.isValid) BigInteger.ONE
                    else BigInteger.ZERO
                }

                return numValidArrangementsByRow.getOrPut(row) {
                    getValidWindowsForFirstDamagedSet(row).sumOf { window ->
                        val rightConditions = row.conditions.subList(window.index + window.value.size, row.conditions.size).toMutableList()
                        if (rightConditions.isNotEmpty()) rightConditions[0] = Condition.OPERATIONAL
                        val rightRow = Row(rightConditions, row.damaged.subList(1, row.damaged.size))
                        getNumValidArrangements(rightRow)
                    }
                }
            }

            private val validWindowsByRow = mutableMapOf<Row, List<IndexedValue<List<Condition>>>>()
            private fun getValidWindowsForFirstDamagedSet(row: Row): List<IndexedValue<List<Condition>>> {
                return validWindowsByRow.getOrPut(row) {
                    val allWindowsOfNonOperational =
                        row.conditions
                            .windowed(row.damaged.first())
                            .withIndex()
                            .filter { window ->
                                window.value.all {
                                    it in listOf(
                                        Condition.DAMAGED,
                                        Condition.UNKNOWN
                                    )
                                }
                            }

                    val windowsBeforeOrIncludingFirstKnownDamaged =
                        allWindowsOfNonOperational
                            .takeWhile { window -> window.value.first() != Condition.DAMAGED }
                            .toMutableList()

                    allWindowsOfNonOperational
                        .firstOrNull { window -> window.value.first() == Condition.DAMAGED }
                        ?.let { windowsBeforeOrIncludingFirstKnownDamaged += it }

                    val windowsThatAreProperlySeparatedFromOtherKnownDamaged =
                        windowsBeforeOrIncludingFirstKnownDamaged.filter { window ->
                            if (window.index - 1 in row.conditions.indices &&
                                row.conditions[window.index - 1] == Condition.DAMAGED)

                                return@filter false

                            if (window.index + window.value.size in row.conditions.indices &&
                                row.conditions[window.index + window.value.size] == Condition.DAMAGED)

                                return@filter false

                            return@filter true
                        }

                    val indexOfFirstDamaged =
                        row.conditions
                            .withIndex()
                            .firstOrNull { it.value == Condition.DAMAGED }?.index

                    return windowsThatAreProperlySeparatedFromOtherKnownDamaged
                        .filter { indexOfFirstDamaged == null || it.index <= indexOfFirstDamaged }
                }
            }
        }

        override fun toString(): String {
            return conditions.joinToString("") { when (it) {
                Condition.UNKNOWN -> "?"
                Condition.DAMAGED -> "#"
                Condition.OPERATIONAL -> "."
            } } + " " + damaged.joinToString(",")
        }
    }

    companion object {
        fun String.toRows(): List<Row> {
            val grammar = object : Grammar<List<Row>>() {

                // tokens
                val newlineLit by literalToken("\n")
                val commaLit by literalToken(",")
                val dotLit by literalToken(".")
                val questionLit by literalToken("?")
                val hashLit by literalToken("#")
                val spaceLit by literalToken(" ")
                val positiveIntRegex by regexToken("\\d+")

                // parsers
                val damaged by hashLit use { Condition.DAMAGED }
                val operational by dotLit use { Condition.OPERATIONAL }
                val unknown by questionLit use { Condition.UNKNOWN }
                val condition by (operational or damaged or unknown)
                val conditions by oneOrMore(condition)
                val positiveInt by positiveIntRegex use { text.toInt() }
                val damagedList by separatedTerms(positiveInt, commaLit)
                val row by (conditions and skip(spaceLit) and damagedList) map { Row(it.t1, it.t2) }
                override val rootParser by separatedTerms(row, newlineLit)
            }

            return grammar.parseToEnd(this)
        }
    }

    override val defaultInput = """#.?#.#???????...??## 1,2,2,1,1,4
???#???.?#?????? 1,2,2,3,2
???????#??.???#? 2,2,4,3
.???????#?? 4,1
?????#????. 1,2,1
#.?#???#???.?#. 1,3,1,1,2
???#?.#.?#??????# 1,2,1,9
.???#????? 4,1
#????#??..????? 1,2
??.#?.???????#??? 2,1,6,3
???.???????.#.#?#?. 1,3,1,1,1,1
???##?????????????## 12,2
???#?????.?#??????.. 9,1,4
?????#?..???????##?? 4,1,1,6
.?#.?.??????.????#. 2,2,5
?##?##.#?##?#????. 5,4,2,1
???..??..????? 2,1,4
?????#?.?##.??##?. 5,3,4
.???.#.#??????.??? 3,1,1,1,1,1
?.???.?#???#??#?# 1,3,1,1,6
.?.??..???#???#????# 1,1,12
..?.?..??? 1,3
???.????????? 3,1,1
.?????.??##??? 3,2
.???????#.### 2,2,1,3
##???.??????#?#?#??? 3,1,1,10
.?##??##??#??? 3,3,1
.????.????????????? 2,1,3,1,1,1
???#??#??.#?? 8,1
???.????.?? 2,1,2
??#?#?.????? 4,1
???????#???#?#?#? 4,9
#.???????. 1,1,3
?#??????.? 1,1,1
?#???##?.???..???? 8,2,1
????????#???.# 9,1,1
???.???#???#?????? 1,1,1,3,4,1
?????##?.??#? 1,5,3
#??##.?.????#???? 1,2,1,6,1
?????#????#???? 1,1,7
????????..??????? 1,2,1,3,1
?##?...???#.?? 4,4
?????#.?.??? 2,3
????.?????#???### 1,1,5,3
#.???#?#?????# 1,3,1,5
.????#?.?????#????? 4,5
.??.???.#?#?#?#.? 2,1,7
.??#?????.?. 5,1
??#??##?.???? 4,2,2
?.?.###?.?#?????##? 1,3,2,5
?#??????#?.??..?# 2,5,2
.????????##?.? 2,4
????##??#???????. 12,2
?.#??.??????#??#?# 1,1,1,9
?#?#??#??#?.???????# 8,1,3,1,1
.?????????.??#? 2,1
??##??.??.? 1,3,1
??.????##???#????# 1,1,7,2,1
????.#???#??##????.? 2,1,9,1
?.??###?.?.??? 4,1
??????#.??????? 6,3,1
??.?????##??. 1,1,6
.#????#??? 1,1,1
??#??.??.?. 4,2,1
?.????????.?.... 1,1
#??..?.#??.?? 3,3
..?#???#?#??#?..#??? 2,8,1,1
???#???.??? 4,1,1
????#?..?.?????? 3,3
??????#????#?.?.?# 12,1,1
#??????????#..? 1,3,1,1,1
???#??#.?#????#? 4,1,2,2
#.?#??#?#???#?.# 1,1,6,1,1
??????.??????. 1,1,2,2
???#???#?. 1,1,1
..??.????#?##??#?? 1,1,9
???.????#?? 1,5
.??.?.???? 1,1,1
??.#????????????#. 1,8,1,2
?#?????????????? 5,1,5
..??.??.#?#?? 1,1,1,3
?????#?????...???? 5,1,1,1,1
.???.??#??# 3,5
???#.????#??????# 3,2,1,1
??????####?.?? 1,8,1
..???#???..??? 4,1,2
????##?#?.#?.?? 2,5,2,1
??##?#???????.??.. 8,1,1
??????????#? 2,1,1
?.?#???#????.???#?? 1,3,1,3,1,3
???????#?? 1,3
???.?#...##???# 1,1,2,1,1
#?.#?#?????. 1,1,1,2
.##.????###?.?.? 2,7,1,1
?#????#???????#???. 9,2
?.#???#??##????? 1,2,6,2
.#?#???.?#??????# 3,1,1,2,3
?#?#??.?..???#?. 4,1,4
?###..?##???#??#. 4,3,1,1
.#??.#????..?..?? 2,1,2,1,2
?..??.??????.?..? 2,3
.?#.??##???????.?? 1,9
???..???????###???. 1,1,8,1
???##??????.? 3,3
???????#??? 1,1,3
??.??????##.??. 1,1,6,2
.##????????????????. 2,5,1,2,1
?#??#????? 1,4,1
#??????.???#???? 4,1,2,1
.##??.??#???#?????? 3,11
.?.??..???.#??? 1,2
...??..??.#????? 2,1
.??#?#?#?#???#?? 9,3
.?#????..##?? 3,3
##??##?????#???#??? 13,2,1
????????????#??# 1,1,6,1,1
?#?##???#??? 1,6
##????#.?#??.#?????? 5,1,2,3,1
??#????#??? 1,4
?.?.?.????##?#?##?? 1,1,1,7,2,1
?????????.??.??. 2,2,1,2,1
??????.????? 4,5
??#?.???#?#??.???? 2,1,6,2
.#.??#...#?.??? 1,1,2
..???.??.?. 1,1
#????.????? 1,1,4
?#.???#??##??? 1,1,3,1
???##???##??#?##.#?? 15,1
?????.#.????? 1,1
???#?#?###??????? 1,8,1,1
?????#????????.#?# 2,7,1,1,1
.????????.#?.#. 3,3,1,1
???##?#?.. 1,6
????#????????#?.??. 6,3
.##?#?.????????? 4,1,2
?#?...????#? 3,4
???.????#? 1,3
???.#??????#??.#??. 3,8,1,1,1
.#???##???? 3,3
??????#?????. 6,1
???.?.?????#? 3,3,1
??##???#????.?#?#?? 4,4,2,1,1
???#??.??.#??#? 3,2,2,1
##?##???????????.? 7,2,1,1,1
.?.??.#????? 1,1,3
?.??????.???#????# 1,1,4,1,2
??#???#?.#?#?##.? 4,2,6,1
..??#..??###?? 2,5
?#????????..?#???#? 3,3,1,3,2
?.???????? 2,2
#?????#?###??? 1,9
??.???##?.???????#?? 1,1,2,10
?#?#.????#?.?#??? 4,5,5
???.????????..? 1,5
???#?????.?#.???##?. 2,6,1,5
.????????###??????? 2,1,6,1
??#?.?#?.???? 3,2,1
.????#????.# 1,1,5,1
??????##?.?..??? 2,3
.?#??????. 2,1
?.?.???????.???????? 1,1,1,4,6,1
??.??.#??##??#???? 1,11
????????##?#??? 12,1
?#??#?#.????#?#???# 6,9
?#???.#?.. 3,1
??#?.?#?????. 4,2,4
.??.?..??#??? 1,4
???#..??.?#??????? 1,1,1,4,3
?###???.?#???? 6,5
?.#?????????.?# 1,2,3,2,2
.?#?.#????##.?. 1,7
?.?#..???????? 1,1,2,2
?????.??#?.?#??..? 1,3,4,1
#??..??????????##? 1,1,1,1,3,5
?????.??#??##???? 2,1,6
..?.?#??###????. 2,4,1,1
##??.#????#?#???.. 4,6,2,1
??#?#??#.#???#??? 4,2,1,6
.#?#????#..?#??#. 8,4
???..???#?..#??? 2,5,1,1
?##?.?.???##?????.?# 2,1,1,7,1
??????#.?.?#???#.? 1,3,1,6
?????????#????#? 3,5,2
?.##?##???#? 5,3
???#?#??#?#?# 1,10
?##??#???? 3,1,3
??#??#????.??.?##. 1,3,2,1,2
???????##????? 1,5,1
??##????#.???# 9,3
?.??????#??.?.????. 9,2
??.??????#???? 7,2
??#?.??.#.??? 4,1,1,2
??.#??#??.?? 6,1
#??????????? 1,1,2,1
?##???##?.?##???? 8,5
?.?#?#??.?#??#?.? 3,4
.#?.????#??#?##.. 2,1,7
?#?.#?##.? 1,4,1
?????##?##??? 7,2,1
??.?.?##???? 2,7
???.????#???. 1,6
?#?????.??. 5,2
????#??.#?#. 1,2,1,1
.???.????#?#?.?? 3,6,2
???.??.?.?.? 1,1,1,1
?#.#????#??#??? 1,7,1
.???#?????#??.?? 1,2,2,1,1
..??.???##..? 1,5,1
.???????..? 2,2
?#????????????#? 2,2,4,1
????..??##?...#????? 1,1,4,1,1,2
?#.???#?????????? 2,4,4
?#??..??.#? 2,1,1
?.?#??????.??#?..?# 1,7,1,1,1
#??#..???? 2,1,1
??#?.??#?.???? 2,2,3
.#???..??? 1,2,1
.??.?#?##.#???.?#? 1,5,3,1
?????.?#?#??????#?? 1,1,7,1,1
??#??????.?#??#?#? 1,5,8
??.?.?.???????? 1,8
?#?#???#?????# 1,9,1
.??#.#??.?#???##?# 2,1,1,1,4
???#???.??#?#? 6,1,1
?###???.?#.?..? 4,2
?#???.????.??#.???. 5,2,1,1,1,1
??????..??.?.##.? 1,2
?.#?#??????...????? 9,1
..??.?.#?? 1,1,2
??##???????????.##? 9,1,1,2
.???.?????? 2,1,1
??#.#?.?#?????.?.? 1,1,1,1,3,1
???#????#????.#. 1,1,7,1
?????#?#?.?.. 6,1
???.???????#??#????. 1,12,1
??.??.?#??# 2,5
?.????#?#????. 1,4,1
???##????#??? 4,3
???????##. 1,1,3
.?.##???#?.?#????? 1,3,2,5
?.??.##??.? 1,2,2
???????#?#???? 3,1,7
#?#.??????#?#??.?.?. 3,2,8,1
.??.??.???? 1,2
???????..?#??? 4,1
?.????##?? 1,5
????#??#??.?#. 7,2
?.##????##?????#???? 2,5,5
.??#.???...##?? 1,1,1,1,2
#??????##???? 1,1,3,3
?###??????????????? 6,11
?#?.#????#??.? 3,2,2
.????#?????#?? 10,1
?????#???? 1,1,5
?#?????.?????#??#.. 1,1,1,1,1,4
????#??.?# 1,5,1
???#?????? 4,1,1
?#?..?.?.?? 2,1,1
#??.??#??#?##??#???? 1,4,1,5,3
?..?#?#??.#???? 4,1,2
?????#???#??#.?#??? 13,1,2
?..#??.??? 2,1,1
???#????#?.????#? 8,2
.???#.???##?????? 1,2,1,9
#..#?#???## 1,5,2
??..?#.??? 1,1,1
??????#?.??.???#. 1,3,1,4
.?##.?..???##?. 3,1,4
?#????#?#?????.? 9,4
??##?.?#??##??. 5,7
??#????####??..#???? 11,4
..#??????? 3,2
?.????????##????.?#? 11,1
.?##????#???. 4,1,4
#???.???????#. 2,1,1,5
#??????#??.?? 1,1,5,1
???????##???#?#.?#? 1,1,5,3,2
?##????##??##? 2,2,2,2
?##?#????..????#?? 5,3,7
.????.#???#? 1,1,2,1
??##???#.?.?#.#?? 7,1,1,3
??.#??#.?#?????.#? 1,1,1,6,1
???????.?#????? 3,1,5
??.?#?.?#?? 2,3
?##??????.?##?? 5,1,4
???.#???#?????#???. 2,12,1
???#??##???#??# 1,6,3,1
??.??.#??####??#?#? 1,2,2,10
??????.?.??????. 2,5
...???.??##?... 1,3
????#..#??#?#?#??### 1,1,13
????????.???.?#.? 4,1,2,1,1
??##??????#????? 7,4,1
???????#?#?#?????#.? 1,1,4,4,1
..?#???#????? 4,4
?#??.##???.#?? 2,5,1,1
.??????#??.#?.?. 1,1,3,2,1
#???.??????????? 1,1,1,9
??.??.?#?.? 1,1,3
#??????#??? 3,4
??#??.??.???#.??# 4,2,4,3
??#???????..?.???### 4,1,1,1,1,4
?.?????#??#?????.. 7,1
?????..?.# 1,2,1
.???###???????###??? 10,6
?#??.?????? 3,1
.#.??#??????? 1,2,1,1
.??#??????#? 1,8
?.?#??..?????? 4,4
?#?#.#.?.?#????? 4,1,1,1,4
?#.?.?###????? 1,1,6,1
.?#?##?###??.?..? 9,1,1
..??????#??????#??? 7,3,2
???#???#?????.. 7,1
??##????.??#??. 5,1
???#????.#?#????? 1,1,1,1,5
????#?????.? 1,5,1
?????#?????????#?..# 4,5,6,1
?????#?#???.?..???? 6,1,1,1,1
?.???#?#?.#?.?.? 1,5,1,1,1
?##????.?.?##?? 3,4
.#?..????. 2,1
??#.##??.. 1,3
?####?#####?????? 11,1
.??.#?..??#.???? 2,3,3
???..????#?#?. 1,3,3
????????#??? 1,2,4
##???.??.#?#????##?# 2,1,11
??.?##??.?..?#??. 3,3
??.#.#.??.????? 2,1,1,1,2
?????..?#???? 4,3
??????#?#??###??? 2,4,5
??#??#?#.?? 8,1
??#?????#? 6,1
??.##?#?#?#???# 8,1
#?#?##???#??#?#????? 1,5,2,1,1,1
.?.#?#?#..??. 5,2
??##?###????? 7,1
?.#???????##????? 1,1,4,2
.??.??.?.?#?????# 1,1,3,2,1
.#???????.??#?? 2,1,4
????##?????.#?? 8,1
????????.#.. 5,1
?????#?#???? 6,1
..?..???????..?#?# 6,3
??.?????#?#? 1,4,1,1
.?????#..???? 2,2,1,1
.#??????#???##??? 1,1,7,1
??.?##??#.????..? 5,1
?.??#.????? 1,1
???.?.?????#??#???# 1,1,1,1,8,1
.?#??.##.##??#??#??? 2,1,2,6,3
?.???#??????.? 4,1,2
?.?????#.?? 3,1
#???##?.?. 6,1
????.???##?#???????? 1,1,4,3,2
.??.?#?.## 2,1,2
???.??????????.?? 1,10,1
.???.?????? 1,1,2
??..???????#?..?#?#? 2,4,3,5
#?##?.????? 4,3,1
???#??#?#????#??#??? 7,7
??#.??##????. 2,4,1
??#??????????.#?? 1,6,1,1
????##?????.?#???? 7,1,4
?.??????????#.???? 9,2
???????##.????#.? 6,5
????#??.??????#???? 3,2,1,5
.???#?????#.?..???. 9,1
#..??.??##. 1,2,4
???????#?#..? 2,1,1,1
?????????.????? 2,5,1
???#?#???.? 1,6
?#???##?#?. 2,6
?..??#???? 1,1,1
?????#?.#.? 2,1,1
.#.????#??#?##?? 1,1,11
?.??.#??#????#. 1,1,1,6
?...##.????#.? 2,2
?????.???#??.#. 1,1,6,1
?#???#????###?#. 1,1,1,8
??#??.?.?. 2,1
#??????????.????##? 1,1,3,1,6
?.?.?????#??????#??? 1,1,9,1
???#??.????????##?## 1,4,4,1,5
.#???????. 3,2
???#.????.?.####?# 1,1,3,6
....??????#???? 3,6
.??????#??????.? 5,3
?.????.?## 2,2
?#????#?..?#? 7,1
.?#??????.??? 6,1
?.?#????????#??. 2,3
?..????#???.?#?? 3,1
##???#???.?.?.? 2,3,1,1,1
?.??#?.?#?#?####?.?. 2,9
.??..##?????. 1,3,3
.?#???##?#??.??..? 4,6,1
?.?#?..??#?#??. 3,6
???#?????##?.??#?#? 3,2,2,6
?#????#?.?#.#? 3,3,1,1
???#??????????????? 1,4,3,6
.##?#?.?#????##?? 2,2,7,1
?????#????.??.?.#??? 8,1,2,1,1,1
#.?.?????#?..????.? 1,1,7,2,1,1
..##?.#?.??#?.# 2,1,1,2,1
??#??...?#???##. 4,2,3
#?#?#????????????? 7,3,1,2
..#??#?##. 4,2
##?####.#??.??.?? 7,1,1,1,1
??#.???##??#.#?#? 2,8,4
?#????#..?.????#?# 2,3,2,4
?.?.#.?????#?#???. 1,1,1,2,1,6
?#???##?#.##???????. 8,6,2
????.??..??##?#? 1,2,1,5
???#??.#?#????? 1,1,1,1,5
????###?#?????? 1,12
???????##????#?##? 1,2,8,3
#.???.?.?#??????. 1,1,1,1,7
?.?#....????. 1,4
??.#???.?#? 1,2,1
?.?.?#???? 1,5
????#?.???#?? 5,1,3
??#?#??#.?.?? 8,1
??#.?#??#.??.?? 1,2,1,1,1
???#???..??#?? 1,1,3
??.#??????? 1,3
?.?#?#?#???????#? 1,8,1,3
?.?####??.?.?.? 5,1
?#???#?.???.?##? 2,3,1,2
.#??????#??..? 3,4
????##?.????#???#? 1,3,1,1,5
???????#????#????#?. 1,2,2,3,1,1
??#..?????#???? 1,2,3
????#?.??? 1,1
??.?#??#???.????? 1,5,2,2,1
..??????#.???# 5,1,1
?#?#?##.????. 6,2
?##.?????.??... 2,4
.????.#?...?##.# 1,1,2,3,1
.????#?#??# 2,7
?#?#.##??#?#??.?#??# 1,1,7,1,2,1
????#?????? 1,3
????##?#?..#?#?#??? 7,5
.?.???.??.?? 1,1,1,1
???.???#??.???#???# 3,4,3,3
.??##???#??#???#??.? 12,2,1
????#?#?#???#.#???.# 1,7,1,1,1,1
.?#?###??#??.?#?? 7,1,1,4
.#????.?#?#. 1,1,3
?#?????.?? 2,2
??.???#.?????? 1,2,1,3
?#.??##???#?.. 1,2,1,2
??.??.???#??? 2,4
???.????.?..?? 2,1,1,2
?#??#####???#.?????? 3,9,2
??.??.??#???#? 1,1,3,4
??#.?.??#???#??. 2,1,2,1,1
?.?????#?? 1,7
?.###????.??. 6,1
.??#??????#?##?? 8,1,4
???##?#???.??.? 6,1
.??..####? 1,4
??????.??????# 2,2,1,1
?.#???#.??#?? 5,3
?...#?#?.???#??.?# 1,1,1,3,1,1
#???.????? 1,1,2
??#..??#?? 3,3
#????.????#?#..?#. 2,1,1,5,1
.#?#??????????????? 1,1,7,1,1,1
??#?????#??.??.?## 11,1,3
#??#????#????? 9,1,1
?????##?????#? 2,8
???????????.???###? 9,1,3
??#?.?.???.#.?. 3,2,1,1
?.??#?#?????.???? 1,4,1,1,4
.##??????? 3,1,1
?????#???#????? 1,1,4,1
.??#?????..#????? 6,6
#??#??#????????# 13,1
??###?????#??????# 9,1,3,1
##???.???#?#?????# 2,2,1,5,1,1
.??...???#? 1,4
?.????.???.???#?#? 2,1,2,3,1
??#?#????? 1,1,2
???#??????????? 3,6
??#?.?#?#. 2,4
.?#????????.??? 3,4,2
????#.???????? 3,8
.??.???#?#???. 2,4
?.??#????#.#.??# 1,8,1,2
..???.?#??. 1,1,1
?????#..?#???# 6,2,1
?###???.#.???#?.??.? 6,1,2,2,1,1
?.??##??##???? 1,3,6
????#.??#??#??#??? 3,2,1,4
#?##?????.##????#? 5,2,7
????#??##?..??? 1,2,3,1
???????#????#?? 1,3,2,1
##??#???????..??#. 8,1,1,1
.##?#?##?#??#?#?#? 12,1,1
??????##?.????? 9,2
????????.. 3,1
?.?#??..?#???.# 1,1,1,5,1
.#???..?#.?#???? 1,1,1,2,2
#.#?#?#?#.#??.???? 1,7,2,1,1
????#??.?#?#??????#? 1,2,1,11
?.#???.??.?#????## 1,2,2,1,5
?#???.??.#?#? 4,2,1,2
????.?.????#??.?? 3,7
?????.#???.# 1,1,1,1
#?.?.???#?##??? 1,1,2,5,1
.?.??#.?#?..?#?????? 1,1,1,2,4,1
??????#.??????? 4,1,1,2
???##??###? 3,4
????.#?????#???#.# 2,2,1,1,1,1
?????.???#??#???? 4,7,2
#.??#?????#?. 1,5,3
?##????.??. 3,2,1
????..??##? 1,1,4
?.#??.?#??.??????#? 1,3,2,1,4
????.?#???. 2,2
#.???#?.?#?? 1,1,1,2
??##?.?#???##??.## 4,7,1,2
?.?????.?#? 2,1,2
????????### 2,6
#?.?????#?# 1,6,1
??#?#??.??????.??.. 3,1,1,4,1,1
?#?.??.#?? 1,2,2
.??????#.#??.#????# 7,1,3,2
??##???###?#??????? 5,8,2
?#.??#?????#??#?? 1,6,1,2,1
?.##??#?#???. 1,2,3,1
#???#????#?#????? 6,1,4,1
?.?#..?????????# 1,1,5,1
???#???.#??? 4,1,1,1
?#??#?##.??? 4,2,1
?####????#? 6,3
?????##??#?##??#???? 1,11,3
?????????????#??#??? 1,1,1,1,1,7
???????.??##.?#?? 3,1,3,3
???#?.????? 3,1
??.#??????#???.?#.? 1,1,1,5,2
?#???#??.. 1,1,3
??#?#???????? 5,1,1,1
?#.???#??#???#?#??? 2,3,9
????##?????.?#???# 1,2,1,2,6
?.????#???????.?? 1,8,1
.??????#?#?? 1,9
.?##..???#??.?# 2,1,1,1,2
.#?#?????#????????#. 1,1,1,2,7
??#??????#?#? 3,1,3
?????.???..???? 1,1,2,1,2
.???.???.#?#? 1,1,1
????#.??#?#?.?##??? 3,2,2,4,1
.????????.#?#??#? 1,1,1,4,1
?.#??##???????? 1,2,2,2,2
.?????#?????##? 3,1,2,2
???#??????.?? 1,3,3,1
.???#?####?#??.?# 1,11,2
#?#..????#?. 1,1,1,2
.???????#??#??? 3,5
?.?.???#?.?#??. 1,1,1,3,3
?.??#?#####?.#???.? 8,4
??.???#?.#??#????#?# 5,5,3
.??????..??? 1,1,3
#????##??????? 3,3,2,1
#?.?##??##????. 1,9
??#??#.????#?.?#?## 3,1,2,3,5
.???#?????.?? 3,1
..????????#???.. 8,1
?????#?.???# 4,2
?.?.????#??.???##? 1,1,2,1,1,4
??#?#..?#???#?#??.?? 4,8,1
?#??.??.?#? 3,1,2
?.?...##???? 1,5
??#?.??????? 2,5
???.??##?#?#??? 1,1,7,1
.??.???????#???? 1,9
??##?.????.?#???#?? 5,3,1,4
#?????#?.?? 2,3,2
??#??#???##??????.? 4,11
???????##????. 1,11
?#??..?#??#??? 2,6
????????#?#????#???? 1,1,8,1,1,1
?..?.#??.???#?? 1,2,2,1
???#?.???#? 4,2
?.??.#?.??? 1,2
???.?????#? 2,3,1
?..#??#???#?#.? 1,1,1,5
?#?#?#??????#.?#???? 13,3
????#?.??????? 2,6
???..#???.????#? 2,4,4
?????#.??#?#??#?##? 1,1,1,6,3
.???????????? 2,5
.??.??.?????.??#?#? 2,1,1,2,3
.?#?#??????.###?#.? 5,2,1,5,1
??.??##???#?.?.????. 7,1
.#??.?#???#?#?????.. 3,12
?..??..#?.?.?? 2,2
???????.?#????. 1,5,2,1
##?.?#.???????#??#? 3,1,1,2,2,1
?.??#?.?????????. 4,1,1,1,2
????.??##? 3,4
?..??.?#???#?#???#.? 1,11
???#??#?????????. 1,4,4,1
#????#?.??#. 1,3,1,1
.???..??????.? 2,1,2
.??????????#?##?.?? 1,7
#.?.#.????#?.#? 1,1,4,2
???#?.?.??#. 4,1,1
?.??#??.?.?.#????# 3,1,1,1,4
??????#?#.?# 2,4,1,1
?.?????##?.??.??? 1,1,4,1,1
?##????.?.#?# 5,1,1,1
..??#??#??. 1,3
??????#?#???..??. 9,1,1
?.#.#?##?##?#???# 1,1,1,7,1
??.?#????? 1,1,4
?.?.??#?#.??#????. 1,5,5,1
???.?#?#??? 1,1,1
??#??????? 1,2,2
..????.??#.? 1,3
???.??..??#?##??.?.? 2,7,1
?#?.???.????.?? 1,3,1,2
#?????#.???# 5,1,1,1
??.??.???#???##??? 2,7
?.?.#?#??.???..? 1,1,3,1,1
.#?.???..###??????#? 2,1,5,5
??.??????????.???? 8,2
??????????? 4,1
??#??#???.#. 3,2,1,1
???#????##?.?#?#? 4,4,4
??#????#?????.. 2,8
?.???.##?????? 1,1,6
??#.?##???#?. 2,2,4
???#?#?????????? 6,1,2
?.????##?###?##? 9,3
?????????? 1,4,1
.??#?????? 4,1
.??##..?#?#? 2,4
?????#??#??#?.#.? 1,8,1
.??.?##?#?#? 1,7
????????#??. 2,6
??#.?.#???.?? 2,4
?##?##???##? 7,3
?#????????#? 3,3,2
?.?????##?? 1,4
.????????.??? 5,3
##.????#??? 2,3,1
?#?.?..??. 3,1,2
????????#????##??### 1,3,3,9
??????#????#????? 2,4,1,6
???.???.#.???#?##? 2,1,1,1,5
???###?.#?????##.. 6,8
???#???#?##.??#?. 3,6,1
?#???...?.??###.??.# 4,1,4,1,1
??????#??#? 1,2,2
??????.??.??. 1,2,2,1
?.?.#????? 1,1,1
.??????.#??? 1,1,1,1
?.?#??#??.????#??.?# 2,2,1,3,3,2
??????.?.#?#???.? 4,1,1,2,1
?????#.###.? 1,2,3,1
???##??#??#???????? 12,4
?#?????????? 3,1,1
?.??#??.????#? 5,1,3
.???##???? 1,2,1
?.???????? 4,1
.#?.?.???? 1,3
??#.??????# 3,3,1
??.?##?.?.??#?? 1,2,1,1,2
.????#??.##??.?#. 2,4,2,1,1
?????.#??. 2,1,1
?#?????#.? 2,1,3
?.?????#?? 1,5
??????#?#..?? 1,1,1,2
?????.????###? 1,2,1,5
.???#?#??? 4,1
.?.?###????? 1,5,1
??????????..?###? 6,1,3
????#?#?#?????###??? 2,3,3,8
??#?..#???? 1,3
???#???.??.?? 4,1,1
??#..???#???#??? 1,1,5,4
??..???##?.??#..? 1,4,1,1,1
#??#.?#????? 1,1,4,1
.??.?##????# 4,2
??#??#????.???# 1,1,1,1,2
?#.????.?.????#??.?# 2,3,1,2,3,1
##???..?.?.????? 5,1,2,1
???.?????????????#?? 1,15
??##???.??#??? 1,5,2,1
.?.??????#?? 2,3
?.#???#??? 1,2
.??.??..???# 2,2,2,1
????#?#??? 1,4
??#??#???? 1,3
??#..??#??????? 1,1,1,8
??????.????#???#.? 1,2,1,6,1
.???##???? 1,2,1
.?????.?#..?. 4,1
#?.???####?#?.???? 1,1,8,1,2
.?.?#..??#??.? 1,3
?????#????????#??. 1,6
#???#??.??# 1,3,3
?????????? 7,1
??.???.??? 1,1,1
??????#??.???????.#? 1,2,1,5,1,1
?#??????????????#?. 5,2,7
#???.?.??.?..#? 3,1,1,1,1
.????????????.???.# 1,9,1,1,1
?#?#??????#???## 6,7
..??#.???#.#.????#? 3,3,1,5
?????###?????##???. 16,1
????????#??????#??# 1,1,7,5
.#?????#???####??#? 2,4,8
?#.????###?#?. 1,1,1,6
?.??????###??#?? 1,1,6,4
.?..??.??.???#?.##? 1,1,1,5,3
?????.?#??#??##? 1,2,1,1,3
?#??.?.#?? 3,3
.?????#??.?.# 1,5,1,1
.???????.??#?##?#?#? 1,5,1,9
????#?#??#. 5,1,1
?#????.##?##?..?# 5,6,2
.?????.??#????#???# 1,3,5,2,1
?##????.#??????#? 6,1,1,1
??##?.????##??#?#?? 5,4,4
.???###??...?????? 1,4,1,1,1,2
???#?..???. 3,2
.?.?.#???##???.. 1,2,6
????#?#?#?????. 10,1
.???#??.??.??? 2,1,2
?..#?.?#?????.?? 1,2,1,3,1
??????.??#?#?#. 1,1,3,3
??#??.?##?????##??? 2,3,4
?#?.#.???? 2,1,1
.?.?#?#?####.?.#?# 1,3,4,1,1,1
??.#?..?#?????? 1,1,3,1
#??#??#??.?# 2,6,1
?#??#???????#??#??? 5,6,2
?..#??#?#####.?#???? 1,10,1,1,1
??.????#???#?##?? 1,9
????.?#.?# 1,1,1
???????????? 6,1,2
#..????#?#?#??##.??. 1,3,1,1,5,2
??#?.????###???? 1,1,1,6,1
????.????#?.?# 2,1,1,1
???##????.?.???.??. 1,2,2,2,2
?????.#?#.???.??? 2,1,1,1,2
???#??????.?? 4,1,2
?#?#?????#?#..??#. 11,2
.?#?##?????###???.#? 6,7,1
#?.##?????# 1,8
#..#????????? 1,3,1,2
????#??#??? 2,2
.?##?.?..?.???.?# 4,1,1,1,1
?.????.?#?.???? 2,1,2,2
??#??#?.?. 6,1
?#??#??#??##..?## 3,1,6,3
??#.???##? 2,4
#??#????.?????..?.? 1,5,2,1,1
.?#??#??#????#?#?? 2,2,10
####????#??##.?????? 5,1,3,4
???##.?.??.? 1,2,1,1
.?#?????##?????##?. 8,4
.?#????###??#??#???? 2,11
???###?#???#????# 9,1,4
??.??.?.?#???. 1,1,4
#???#??#?#?#???##? 1,3,1,1,1,2
#????##?.? 1,6
##?.?#?#??#?? 3,7
??##????#?.?.?#?#??? 1,2,5,1,1,4
.?#?#?..#?.... 4,1
##?#?#??????. 2,4,1,1
?????????#?????? 1,3,1
?.??#??????? 3,1
###?????#?#??#.#??. 3,2,4,1,1,1
.#???.??###? 1,1,5
?###???.?????. 5,2
?##???????????.? 3,1,5
??#??#?####??.?? 9,1,1
##??#..??????.??#??? 3,1,1,4,2
.???.???...?????? 1,1,5
.?????#????# 3,2,2
.####?.???? 4,1,1
?#.?#??#??##?????? 2,12
.????#?.???? 2,1,2
??#????#??#?? 3,5
?????#???#.?..??#??# 9,2,2
??????.?#? 1,1,3
?#?.#?????. 2,1,1
?#??.???.? 2,1
???????#?.. 6,2
#?????#?#??..# 10,1
?????????. 1,2
...??.##?????#??.?? 8,1
#??????#??##???.? 2,4,6,1
?.##????#??#.?#???# 3,1,1,2,2,1
???#??.???? 1,2,1
#..??#??#??.?????.? 1,4,2,3,1
?#?#.??###??##? 4,9
.???#.??.? 4,2
?..?.?#.????#.?? 2,2
.???##??#???###.?.?? 6,7,1
??##???#?.?? 4,1
??##?#????#?????#.? 13,1
???#?.#?##?.#?#? 3,5,1,1
??.???#????. 1,5,1
.??#???.???. 5,2
??????.#??#.??? 5,4
??#????#?##???.?#??? 12,3
#????????? 1,1,2
???????????#?.. 1,1,1,1,2
??#??#?##????#???#?? 1,2,9,2
?????..??????.??#.?. 3,3,3
??.?#?#?????##?.#?.? 4,6,1,1
??#????##.???? 8,2
?#?.??.#?#?##????? 2,1,9,1
???#???#?..??.?.. 7,2
#.??#??#???.????.?#? 1,9,1,1,2
????##?.?.??.?????## 7,1,2,1,1,2
.?#?#???#???#.?.. 6,1,1,1,1
??.?#??#????.? 1,3,5,1
?#?.??#??? 2,3,1
???#?##???????? 6,1,1
?#?.?????#?????#?. 2,5,5
#?#?#??#???.???? 6,1,1,2
?.??#????#?.??###?. 8,5
.##??#??#???.? 2,2,1,1
???##?.??? 1,3,1
?##.?.????#.#..?# 2,1,3,1,1
?#?#?...?#?#????.??? 4,3,2,3
..##??..????#?????? 2,9
?#??.?#?#?????#???. 3,5,4
???#?????.#???#??? 1,1,1,1,5,2
????.??.#?#??# 2,1,3,1
?#??#????#???.#? 12,1
??????????#??????.?# 1,7,1,2,2
??.????#?##????#? 1,2,1,4,2
??###????? 1,3,1
?#?#???#???.??# 3,1,1,1,2
???#????????. 6,1
##..????.? 2,3
?##????... 3,3
.?.?.?.#?? 1,3
.?.???????????????? 8,7
??#?###?.??..?? 7,1,1
?????.?#?#? 2,3
??#.??#???????#????. 1,7,1,3,1
?????.??#?? 1,1,4
.?????##??# 3,4,1
..??.??#??. 1,1
??????????.#??#?#? 6,7
##???????? 4,4
?????##.?#??. 5,2
#?.?????#??? 2,2,1,1
??#??...??? 4,1
???#??.???#? 1,2,4
??#?????.#? 1,5,1
????.??##?? 2,1,3
?????.??.?.? 3,2,1
.#??.???.?.??#??#?? 2,2,1,2,1,1
#????.??..??#?.#?## 5,1,1,2,4
???????##.????.?#? 7,1,2,2
.???.???????#??????? 1,2,1,5,2
.?#????.??? 1,1,2
.#?#?#?#??#???#..??? 1,10,1,1
??.????#?.????????#? 1,3,2,1,8
?????##??#??.????.. 5,2
..?#???#?##?#??? 2,2,5
??#.?#.??????#? 2,2,1,1,2
.???.????#????? 1,8
??##?###??????#???? 8,3,2,2
???..#.??#? 2,1,2
?#???#???.?# 7,1,1
.#?.???#???#? 1,7
???.??#???..??.? 3,2
..?.#????????. 1,1,1,3
????#??#???#??????? 9,1
.?#????.?...?. 5,1
#??.?????.???#??#?? 3,4,5,1,1
????###??#? 5,1
#???##?#??.?.?????? 10,1,2
?????#?##??.?...##?? 1,6,4
???????#???.?##??. 4,4
#.??#?#.#??.??# 1,2,1,2,3
?????.??????? 2,1,1,1
?????#.##??#?#? 1,3,7
.??????#?#???.??.?. 12,2
??#????.####??#??.?? 3,1,4,3,1
?#.#?????#.?#? 1,7,2
?.?????.?????? 3,4
??????#?.????#???? 2,1,1,1,6
???.#???#? 1,1,2
????#???#??. 6,3
#?##????.?? 6,1,1
?.???##?##.??? 7,1
????.????#.? 2,5
.?#???#???# 1,3,3
##????..#??###???.?? 6,2,4,1,1
?????#?..?#???#?? 2,2,8
??#?##??..?#????#??? 5,3,2,2
???#?????#?.???? 1,7,2
.?.???#????.??#???? 5,1,1,1,2
#????????#?.?#?? 11,1
???#??#??? 1,5
?#??#??????#? 2,1,4
????.#??#.??? 1,1,1
.?????????? 7,1
.??#?#???.??. 1,5,1
#???#?????.#..?..? 1,1,6,1,1,1
?..??.???#???? 2,5,1
???????..??##???.. 3,7
#????.????? 5,1,2
.??#????#???? 1,3
?##????##?. 3,1,3
.?..??#??? 2,1
??#?#????.?# 4,3,1
?##?..????#??#??#? 2,6,1,2
??#??#?###???##?#.#? 1,1,12,1
??##??.#?#??#?.? 1,4,7
??##?#??#??? 6,2,1
????.???.?#?#?##? 2,2,6
#????.????.# 4,1,1,1
#?????#?.???? 1,1,1,3
?#???.##?##?#?#?.?# 3,2,2,4,2
..#?#??#?????#?? 4,9
??#?.??#?. 3,3
.??.????????# 1,2,1,2
?.????..?????????? 1,2,6,1
??#??.????#??.????#? 5,3,3,1,2
.#?.????.????#?? 2,1,2,5
#?.##????#? 2,3,2
..#?.#?##???.?#?#? 2,4,1,4
????????????#??.?#? 4,1,5,1,1
#?#????#..#????##??? 1,1,2,1,6
?#???#?#?????? 2,8,1
?#???.?#?? 2,1,4
?#???.???#?# 1,2,6
?#?##?.??# 5,2
?#???.???????? 3,1,7
?.???????????#?????? 1,3,1,4,1,2
..???????.??? 1,1
#?????#??#.?.#.??..? 10,1,1,2,1
?.?#??????? 4,2
.???#????##?????? 10,2
?#??????##. 1,1,2
###???????#..??#.?? 11,3,1
.???#??.?#??? 2,1,2
.?.?###?##? 1,3,2
#.#?#??####?#?????. 1,1,10,1
.??.????#?#? 1,5
#???????#.??? 3,1,1,1
#..????#??#?#?##. 1,13
?.???.?#?.???#.???? 1,2,2,2,1,3
?..????????. 1,2,3
?.????.?....#????? 2,1,1,6
?##?..??#. 3,3
???.#???..??#.. 2,1,1,3
.?#??.????? 2,1
??????.???. 1,1,1
???#.????#???????. 1,1,8,1
???##???.??#??? 3,1,1,2
????#?..??? 1,2
???#.#??#???##?.??? 1,1,1,7,1
?.????#.?????? 1,5,3,1
????????.??#??#.??.? 1,6,3,1,1,1
..???.?..?#?? 2,1,1,1
???.??..????###?#? 1,1,1,7
??.????.????###? 2,6
????#??#?.?# 1,4,2
.#.##?.?????. 1,2,2
?.????????? 2,2,1
?#???#???.??? 2,1,2,2
???????##? 1,6
#.?????#.#????# 1,4,6
??.##?#?????.#?????? 2,9,1,2,1
##.?..?####?##?? 2,8
???#?.???#??#????? 3,10
?#?????????.?#?????? 10,4,2
.???.????#????? 1,3
#??.?????? 3,2
.??????.?#?#?? 1,1,6
?????????#.# 1,1,1,1
??#.?#???????#.????? 2,6,2,5
??.?#?##??#?#?##??? 13,1
.?.?#???##? 1,1,3
#??????.##. 1,2,2
?##??#????? 6,1
?#????#??#.??.# 6,1,1,1
##...???.?. 2,1
?###???#.#?#?..?.?? 8,3,1
??#?.???##???????#. 1,1,1,4,1,1
#####?.????#???# 5,1,1,3
#???###??..?#? 2,6,2
?.???#??.#?? 4,1,2
????#?#?????????# 1,9,1,1
?##??????#? 3,2,2"""
}