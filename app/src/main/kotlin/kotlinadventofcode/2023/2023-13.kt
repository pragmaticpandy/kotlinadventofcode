// Originally generated by the template in CodeDAO
package kotlinadventofcode.`2023`

import com.github.h0tk3y.betterParse.combinators.*
import com.github.h0tk3y.betterParse.grammar.*
import com.github.h0tk3y.betterParse.lexer.*
import kotlinadventofcode.Day

class `2023-13` : Day {

    override fun runPartOneNoUI(input: String): String {
        val grids = input.toGrids()
        val leftSum = grids.mapNotNull { it.leftReflectionLengths.firstOrNull() }.sum()
        val topSum = grids.mapNotNull { it.topReflectionLengths.firstOrNull() }.sum()
        return (leftSum + (topSum * 100)).toString()
    }

    override fun runPartTwoNoUI(input: String): String {
        val grids = input.toGrids()
        val leftSum = grids.mapNotNull {
            (it.withSmudgeFixed.leftReflectionLengths - it.leftReflectionLengths).firstOrNull()
        }.sum()

        val topSum = grids.mapNotNull {
            (it.withSmudgeFixed.topReflectionLengths - it.topReflectionLengths).firstOrNull()
        }.sum()

        return (leftSum + (topSum * 100)).toString()
    }

    companion object {

        enum class Terrain(val char: Char) {
            ASH('.'),
            ROCKS('#');

            override fun toString() = char.toString()
        }

        data class Coord(val x: Int, val y: Int)

        data class Grid(private val grid: List<List<Terrain>>) {
            private val xIndices = grid.first().indices
            private val yIndices = grid.indices
            private val allCoords = xIndices.flatMap { x -> yIndices.map { y -> Coord(x, y) } }
            val leftReflectionLengths by lazy { getAllLeftReflectionLengths() }
            val topReflectionLengths by lazy { Grid(grid.transposed()).leftReflectionLengths }
            private fun get(coord: Coord): Terrain? = grid.getOrNull(coord.y)?.getOrNull(coord.x)
            val withSmudgeFixed by lazy {
                getGridsWithOneFlip().first { altGrid ->
                    altGrid.leftReflectionLengths.let { it.isNotEmpty() && it != leftReflectionLengths } ||
                        altGrid.topReflectionLengths.let { it.isNotEmpty() && it != topReflectionLengths }
                }
            }

            private fun getAllLeftReflectionLengths(): Set<Int> {
                return xIndices
                    .windowed(2)
                    .mapNotNull { if (isMirrorLine(it[0], it[1])) it[1] else null }
                    .toSet()
            }

            private fun isMirrorLine(left: Int, right: Int): Boolean {
                return yIndices.all { y -> isMirrorLine(left, right, y) }
            }

            private fun isMirrorLine(left: Int, right: Int, row: Int): Boolean {
                return xIndices.all { distanceFromLine ->
                    val leftTerrain = get(Coord(left - distanceFromLine, row)) ?: return@all true
                    val rightTerrain = get(Coord(right + distanceFromLine, row)) ?: return@all true
                    leftTerrain == rightTerrain
                }
            }

            private fun getGridsWithOneFlip(): List<Grid> {
                return allCoords.map {
                    val newTerrain = if (get(it) == Terrain.ASH) Terrain.ROCKS else Terrain.ASH
                    val newGrid = grid.toMutableList()
                    val newRow = newGrid[it.y].toMutableList()
                    newRow[it.x] = newTerrain
                    newGrid[it.y] = newRow
                    Grid(newGrid)
                }
            }

            override fun toString(): String {
                return grid.joinToString("\n") { row ->
                    row.joinToString("") { it.char.toString() }
                }
            }
        }

        fun <T> List<List<T>>.transposed(): List<List<T>> {
            val result = Array(this.firstOrNull()?.size ?: 0) { mutableListOf<T>() }
            this.forEach { row ->
                row.forEachIndexed { index, element ->
                    result[index].add(element)
                }
            }

            return result.map { it.toList() }
        }

        fun String.toGrids(): List<Grid> {
            val grammar = object : Grammar<List<Grid>>() {

                // tokens
                val newlineLit by literalToken("\n")
                val dotLit by literalToken(".")
                val poundLit by literalToken("#")

                // parsers
                val ash by dotLit use { Terrain.ASH }
                val rocks by poundLit use { Terrain.ROCKS }
                val terrain by (ash or rocks)
                val row by oneOrMore(terrain)
                val grid by separatedTerms(row, newlineLit) map { Grid(it) }
                override val rootParser by separatedTerms(grid, 2.times(newlineLit))
            }

            return grammar.parseToEnd(this)
        }

    }

    override val defaultInput = """.####.#...##.#.
...###.##.#.#..
...###.##.#.#..
.####.#...#..#.
..##......#..#.
#.#...#.##...##
.#.#.#..##..##.
#..##...#####.#
.#.#.#.#..##.#.
.....###.#.#..#
.....###.#.#..#

.#.###.....
#..#.##...#
.#.....#.#.
.#.....#.#.
#..#.##...#
.#.###.....
##.#..##.##
#....##..#.
.##.##.#.##
...#..###.#
...#..###.#
.##.##.#.##
#....##..#.
####..##.##
.#.###.....
#..#.##...#
.#.....#.#.

###....##....
####..#..#..#
..###.####.##
..#..######..
...#.######.#
#####.#.##.##
##.#..#..#..#
##....####...
....#......#.
.....#.##.#..
##...##..##..
...##.#..#.##
##..###..###.

.##.#...##.
.#.########
.##.#.#.##.
#.##..#....
####.##....
####.##....
#.##..#....
.##.#.#.##.
.#.########
.##.#...##.
..####.####
.##.###.###
.#..#.#.##.
#.####..##.
...#..#....

.....##..#.
.##..##.#.#
#..#...####
####.....##
#..#.##....
#####.....#
#####.....#
#..#.##....
####.#...##
#..#...####
.##..##.#.#
.....##..#.
....##.##..

#####..
.##.#..
.##....
.##...#
.##....
#..####
..#.#.#
#####..
#####.#
.##...#
.##.##.
.##.##.
.##...#

.##.#.##.##.##.##
.##.####....###..
.##.#.#.#.##..##.
#..#.#..#.#.##.#.
....####...####..
#..##.#...######.
....#.#..........
#..#.##.####..###
#####...##......#
....###..##.##.##
####..###..####..
.##..##..#.####.#
#..##..##..#..#..
.##..#.#.#..##..#
####..####.####.#
####.....###..###
#..#..##.##.##.##

.#..#.#.#####
#.##.#.#.#.##
#.##.#.#.#.##
.#..#.#.#.###
##..##..###..
##.####.#####
.##.#.#...###

.###.#.###.###..#
...####.####..#.#
#..####.####..#.#
.###.#.###.###..#
...###..#..##....
.#.#####.###..###
#.#.#####.#.#####
.##.###.#...###..
.##.#.....##..##.
#..##.####...##..
#.#.#..#....#.###
..#...#...##..##.
##..#.######...##
###.#.####..#..##
...#..##..##...##
###....##.#..#..#
###....##.#..#..#

##.###..####..#
#.###.###.##..#
..##...##..##.#
..##...##..##.#
#.###.###.##..#
##.###..####..#
....#####.#####
##..#....#.#..#
##.#..#.#...#..
.##.#..##.#.###
.##.#..##.#.###
#..#..#.#...#..
##..#....#.#..#

.###.#....##....#
#.##.##........##
...###.#..##..#.#
...###.#..##..#.#
#.##.##........##
.###.#....##....#
.###..#.##..##.#.
.###.#...####...#
####.....####....
###...##...#..##.
.#..#.#.#.##.#.#.

#.#..#.
#.#..#.
#......
###..##
##.##.#
..####.
#......
##.....
.##..##
..#..#.
..#..#.
.##..##
...##..

##.#########..##.
...#.####.#.##..#
##.#...#..##..##.
....#..###.##.#.#
....#..###.##.#.#
##.#...#..#...##.
...#.####.#.##..#
##.#########..##.
##...####...##...
###...##..###.#.#
...#.#..##.#.....
.........#####...
....##..#.#.##.##
...#.#.###.....#.
...##..#.##.#.#.#
##...##....#.####
###....###......#

..##.##.##......#
.###....###....##
#.###..###.####.#
.##########.##.##
...##..##........
###......###..###
.##########....##
.#.######.#.##.#.
.....##.....##...
####.##.####..###
...#....#........
.##.#..#.##.....#
..##.##.##......#

####.##
.##..#.
..###.#
.##.#.#
###.#..
##...##
##...##
#####..
.##.#.#
..###.#
.##..#.
####.##
####.##
.##..#.
..###.#

#.###..
.....##
..#....
.#.##..
..#.###
..#..##
.#.##..

#..#.###....#####
##.####.####.####
#...###..#..#.##.
..###.#.##.....#.
..#....####..####
...#.###.#.##.##.
.#...###.#..#####
.#.#...##.#......
.##.##..#.....##.
.#..#.#...##.#..#
.#....##.##.##..#
###..####.###....
###..####.###....

######.#.##....
.####.#..##.##.
.####.##..#....
.####.#.#.#####
#....#..####..#
.####...#.#....
..........##..#
..##..#.#####.#
######.#...####
#.##.##.....##.
.#..#...##.####
..........#####
#.##.#####.#..#

#####.#
##.##.#
#.#.###
...##.#
######.
......#
......#
######.
...##.#
#.#.###
##.##.#

.#..#.#####...#..
#######.#.#.....#
#....#...#.#...##
######...###...##
.#..#..###..#..##
#....##..#...##.#
.####..##.###.##.
.#..#.##.###..#..
#....#.#.##.##.#.
.#..#.#...#.##...
.####.##.#.#....#
.......#.##.#.##.
.......#.##.#.#..
.####.##.#.#....#
.#..#.#...#.##...

##.####
..#....
###....
.##....
#.#....
#.#....
..#....
###.##.
#..####
#.#####
###....
#..####
.######
##.####
.#.....

###.##....##.##
##.##......##.#
####...##...###
....#.#..#.#...
....#.....##...
#####..##..####
###..##..##..##
###..#.##.#..##
###..#....#..##
#####.####.####
..#.#..##..#.#.
..#..#.##.#..#.
##............#

###.#.##.#.#.#.
###.#.##.###.#.
##..#...##....#
.#..###.###..##
#.#......###.##
........##.##.#
........##.##.#
#.#......###.##
.#..###.###..##
##..#...##....#
###.#.##.###.#.
###.#.##.#.#.#.
.#..#.#...#.###
.....##.#.##.#.
.#.###.#.###.##
.#.#.....###.#.
##....####.#.##

###......###.
##.######.###
###.####.###.
##..#..#..##.
..##....##...
###..##..###.
####....#####
####.##.####.
##.##..##.##.
#...####...#.
...#....#....
...#....#....
..#.#..#.#..#

.##..##.###..##
.##.#...##.#.#.
.##.#...##.#.#.
.##..##.###..##
#...#.#..####..
.#.#....#.#....
#..##..#..##...
##....####..#..
.#.....#.###..#
..#....#.#...#.
.##...#.#..#.##
...##.#..######
.###.......####
.###.......####
...##.#...#####

.#........#.##.
#.##.#...##.#.#
###.####...##.#
###.####..###.#
#.##.#...##.#.#
.#........#.##.
...#.##.#.#.##.
#.####.###.####
.#...##.##.###.
.....#..#.####.
##.##.##..##..#
.....#..#.....#
##.##.#.#####..
##.##.#.#####..
.....#..#.....#
##.##.##..##..#
.....#..#.####.

######.##.###
.#..##.##.##.
#.#.##.##.##.
#.#..#.##.#..
....#.####.#.
#...#..##..#.
####.#....#.#
.###.######.#
####.###.##.#
....###..###.
..###.####.##
..###.####.##
....###..###.

..##..##..#
..###.#....
##....#....
###.#.#.##.
##.####.##.
##...##.##.
...##..####
##.#####...
...#.##....
..#####.##.
...#..##..#
..#.#..####
##.....####
...##.#.##.
..#####.##.
.....#.#..#
##.##...##.

#......##.##.##
..####..#####..
..#..#...#..#..
.######.##.#...
..#..#....#####
...##....######
.........#.##..
.##..##.#......
####.####.#.###

#......##......##
..####....####...
..#..#....#..#..#
...##......##....
################.
.#....#..#....#..
...##......##....
.#....#..#....#..
##....####....##.
..#..#....#..#...
..#..#....#..#..#
##.##.####.##.##.
###..######..###.
..####....####...
...##......##....
####.######.#####
.#.##.#..#.##.#.#

...##.##.##..
##..........#
##..##..##..#
..#.######.#.
##...####...#
...##.##.##..
###..####..##
##...####...#
...##.#..##..
....##..##...
##..#.##.#..#

.#.##.####.##.#..
##..###..###..##.
##..##....##..##.
#.#.##....##.#.#.
#.#.###..###.#.#.
##...##..##...###
#..#.##..##.#..##
....#.#..#.#....#
....#.#..#.#.....

.##.#.....#...###
###..#.####..####
##....#..####....
#..###..#.#..####
..#.####.####.##.
.##....##...#.##.
.##....##...#.##.
..#.####.####.##.
#..###..#.#..####
##....#..####....
###..#.####..####

##..#.#..#.#.
##.###.##.###
#######..####
##..##....##.
##.####..####
#####..###.##
####...##...#
....###..###.
..##..#..#..#
..#..##..##..
##.##.#..#.##
###.###..###.
...##.####.##
##.###.##.###
...#...##...#
..#....##....
.....#....#..

..#.##.##
..#..####
#...#.##.
#...#.##.
..#..####
..#.##.##
######...
#.##..#..
.#.....#.
###.###.#
#.##..###
.#..#..#.
###.##...
###..#...
###..#...
###..#...
.#..#..#.

###.###.##.
###.###.##.
##.#.##..#.
....#.##.##
.#.##.##.##
###....####
###.##..#..

####.#..##..#.#
.......######.#
####.##.....#..
####.##.....#..
.......######.#
####.#..##..#.#
.##.####.#.#.#.
######....#.#.#
.......#....#..
###...###.#####
#..#..#####.###
......##.##.#..
.##.###.###...#
####...###.####
#####.###...#.#

#####....
#...#####
#....####
#..##..##
#..##..##
#....#.##
#...#####
#####....
#..#..#..
.#....###
##.#..#..
.#...####
###.#.###
##.#.....
##...#.##

....#.#.#......
.....#.#####...
....###..#.#...
..#...#..##.###
####...##..####
.##...##.###.##
#..#..#........
#..###..##.....
.....####...#..
.##.#.#.###.###
####.##.#.#.###
.....#.#.....##
########...####
#..###..###..##
.##.###.#..####

.#.#..##.#.#.#.
....##.....##..
#.#.####..####.
#..#..##.###...
#..#..##.###...
#.#.####.#####.
....##.....##..
.#.#..##.#.#.#.
.#####..#..####
#....#.#..##..#
#..#.#..##.#..#
#.##..#..#.#..#
.####..##.#..#.
.####..##.#..#.
#.##..#..#.#..#
#..#.#..##.#..#
#....#.#..##..#

#..#######..#.#..
#.#...#.###..####
##....###.###.###
.........#.#.....
.#.#..####...##..
#.#.##.#.###...##
#.#.#...####.....
#.#.#...####.....
#.#.##.#.###...##
.#.#..####...#...
.........#.#.....
##....###.###.###
#.#...#.###..####
#..#######..#.#..
##...#.####....##

....######.
###.....#.#
###.....#.#
.#..######.
.#..######.
###.....#.#
###.....#.#
....######.
.#####.###.
#..#......#
##....##.##
.#.#.#..#.#
.####....##
##...#.#.#.
#...###..#.

########..###
....###....##
....###.##.##
####.........
....####..###
#..##..####..
######.####.#
#..#...#..#..
####...####..
.##.....##..#
#..##########
#..#..######.
.##.#..#..#..

#.##.####.#....
#.##.####.#....
##...##.##..###
..#..#...#.#..#
#.#....#.##...#
.#.####.#...#.#
####.#.#....###
.##.#.####...##
.##.#.####...##
####.#.#.#..###
.#.####.#...#.#
#.#....#.##...#
..#..#...#.#..#
##...##.##..###
#.##.####.#....

###..##
###..##
#..##.#
.##....
.##....
#..##.#
####.##

....#...#..#.
.##..#..#.#.#
####.##.##.#.
###.###..#...
#.#.#...###.#
#.#.#...###.#
###.###..#...
####.##.##.#.
.##..#..#.#.#
....#...#.##.
#.###.##.##.#
#.###.##.##.#
....#...#.##.
.##..#..#.#.#
####.##.##.#.

..#..#........#
...##....#.#...
##....###...#.#
##....##.###.#.
...##...#.#.#..
........#######
##....##.#.....
..............#
#########.##.#.
........#.#.##.
#########..##..
.######..##..#.
..####..###..#.
..####.....#...
..####...##....

..#####.###
...####.###
.....#.#...
.####..##.#
##...#..###
##...#..###
.####..##.#

#..##.###.####.##
########.##..##.#
.##....##.####.##
#######.#......#.
####..##...#....#
####..###########
....#############
......##.##..##.#
#######..##..##..
#..##.#...#..#...
.##.#.##.##..##.#
.##..###..#..#..#
....#.##........#
.....##.#.####.#.
.##.#.##........#

.##....#...#.#...
.##....#...#.#...
..#...###.#####..
.####...#..#..##.
##.###.#.....##..
.....##.#..#.#.##
.#.##....##.#.#..
#..........####..
#.....###.##...##

#.###..##..
.#..#.#..##
###..##....
###..##....
.#..#.#.###
#.###..##..
####.#..###

.....#.####..#..#
.....#.####..#..#
..#.#..###.#..#.#
####..#####.##...
..#.##..###.....#
##...#.###.#..#.#
###.#.#...#...###
.###.....#.##..#.
.###....##.##..#.

...#...#..#.##..#
#..##.#..####.##.
.##..#.#..##..##.
..##..###....#..#
.#.....###.#.####
###..#.#.##...##.
###..#.####...##.

##.##..
..#....
.#.#...
##.####
##.####
...#...
..#....
##.##..
#.#####
##..#..
.#.#...
..#.#..
###.###
....###
.##.#..
#..#.##
##...##

###.#....#.##
#..#.#..#.#..
#..#.#..#.#..
###.#....#.##
#.###....###.
.##...#....##
...#.####.#..
##..##..##..#
..#..####..#.
.##..####..##
##..#....#..#
..##.#..#.##.
.##.#....#.##

..#######
...##.##.
##.#.####
#.#..#..#
.#.##....
#.##.#..#
...######
#..######
#.##.#..#

######.........
.##..##..##..##
.......##..##..
.#.#...#.##..##
#.#.##...#....#
.##..#.....##..
.##..#.....##..
#.#.##...#....#
.###...#.##..##

####..#.##.#.
###.#.#.##.#.
#.##..#.##.#.
....#..#..#..
.#.###.####.#
##..#.######.
.#.##.#.##.#.
#.##..######.
#.##..######.
.#.##.#.##.#.
##..#.######.
.#.###.####.#
....#..#..#..
#.##..#.##.#.
#.#.#.#.##.#.
####..#.##.#.
.#..#.#.##.#.

.#........#..
#.###..###.##
.#..####..#..
#.#.#..#.#.##
.#.#.##.#.#..
.##..##..##..
#...####...##
..#.#..#.#...
...#.##.#....
#..#....#..#.
..#.####.#...
.##########..
.#........#..
#..#....#..##
..##....##...

.##..###...#...
.##.##.########
#.#.#..#..#..#.
.#......###..##
....######.##.#
.#.##......##..
##.#...###.##.#
##.#...###.##.#
.#.##......##..
....######.##.#
.#......###..##

.##...##.
#..#.###.
####.....
#..######
.##..#..#
.##.#####
....#####

.###...#####.###.
..##...#..##..##.
..##..#..#...#..#
##..###.#.#.#.##.
##..##.#.#......#
##..###...##.###.
........##.###..#
.####.#....###..#
#.##.###..#..###.
.........#.#.#..#
##..##.#.##..###.
##..##.#.##..###.
.........#.#.#..#

....#......#...
....###..###...
.....######....
##.#.#....#.#.#
##.....##.....#
..##..#..#..##.
..####....###..

.....#.#..#
#####.#####
#..########
#..#.######
#....#..##.
.##.#..#..#
#..#..#####

#.##.#..#
##..#.##.
..###.##.
..#...##.
#.#...##.
###......
###......
#.#...##.
.##...##.

.......#.
.......#.
.#..#.#..
.####...#
..##..#.#
########.
.####.#.#
..##.....
..##...#.
#....#..#
##..##.##
######...
.#..#.#.#
#.##.###.
#.##.##..
....#...#
######.##

#..#..#........#.
....##..#.##.#..#
....##.#..##..#.#
.....#...#..#...#
####..#.##..##.#.
.##.#####....####
....#.#.##..##.#.
...######....####
######..##..##..#

###.#..
####..#
..#....
###.##.
...#..#
..#.##.
###.##.
###....
..#.##.

.#..###....#...
##...#...###...
.#..#..##...#.#
.#..#..##...#.#
##...#....##...
.#..###....#...
###..###..#.#.#
#.##.#.#.#####.
#......##...#.#
###....#.#.#.#.
###....#.#.#.#.
#......##...#.#
#.##.#.#.#####.
###..###..#.#.#
.#..###....#...
##...#....##...
.#..#..##...#.#

..##.#.
##.##..
..##.#.
...##.#
#.#####
..###.#
..#.##.
###.###
##...#.
..####.
..####.
##...#.
###.###

.##.#...#.##.
#.####.####.#
####...#.#..#
.##.#.######.
######...##.#
.....#..#.#..
.....#..#.#..
######...##.#
.##.#.######.

.###.#.#.
...#.##..
##.....##
###..#.#.
#.#..##..
...#..##.
.......#.
.......#.
...##.##.
...##.##.
.......#.
.......#.
...#..##.

...##....####.##.
.##..###.#...####
###..###.####.##.
.######.#....####
########....#.##.
..#..#..##..#....
.##..##...#......
..#..#..##.###..#
#.####.##.#......

#.#..#####..#..
##.##.####..###
#......#.##.#.#
###..####.##...
#.#..#.###...#.
.#.##.#.#.#.###
##.##.##..#.###
.##..##.#####..
#......#.##....
#......#.##....
.##..##.#####..
##.##.##..#.###
.#.##.#.#.#.###
#.#..#.###...#.
###..####.##...
#......#.##.#.#
##.##.####..###

####..#####
.....#..###
#..####.#..
.......##..
#..#..#.###
####.......
.....#.#.##
#..##..#...
.##...##..#
.......###.
.##..##..##
....#....##
####.#.##.#
#####.####.
#####.###..

#..#.####.#.#..
#.#####.#.#####
##.#...##.#...#
#..#.##...#.##.
#..#.##...#.##.
##.#...##.#...#
#.#####.#.#####
#..#.####.#.#..
#..#.######.###
.....####....##
.##.....##.####
......#.##..##.
......#.##..##.
.##.....##.####
.....####.....#
#..#.######.###
#..#.####.#.#..

#.#...###
#.#####..
.###.....
.###.....
#.#####..
#.#...###
.#.....#.
.#..###.#
.#..###.#
.#.....#.
#.#...###
#.#####..
.#.#.....

..........###
..##....#.###
..##....#..##
..........###
.####...#....
.####.######.
##..##.######
.####.....##.
.####.##.###.

######..##.
.#..#..#..#
#######.##.
######..##.
.####.##..#
.####.#....
.####...##.
.#..#.#####
##..#######
.####.#....
#.##.##....
..##....##.
.#..#.#####
##..##..##.
.####...##.
#.##.##..#.
#....###..#

#...#..#....#.##.
..........###.##.
....#.#.###..#..#
.###...######.##.
.###....#####.##.
....#.#.###..#..#
..........###.##.
#...#..#....#.##.
##.###.###...####
#......#...#.#..#
..#..##..........
.###.###.##...##.
..##.#####..#####
....#.##.#.##....
....##.#..#.##..#
...#####....##..#
....#.###..#.####

...######...#
##.##..##.##.
##.#....#.###
####.##.#####
#..........##
....#........
.####..####.#
.#.##..##.#..
#....##....##
#..........##
....####.....
##.##..##.###
##.##..##.###

###..##
##.#.#.
..#...#
##..#..
#####.#
###..#.
###....

#####.#
...####
.##....
...#..#
#.#....
.######
###....
###....
.######

..#..####..
####.####.#
####.####.#
..#...###..
##...#.#.#.
...####...#
....#...##.
..#.###.#.#
#######.##.
...#...##.#
..#.#.#...#
####.#....#
.....#..#.#

######..#
..##...#.
##..##.#.
#....###.
#....##..
##..##.#.
..##...#.

#.##..#
#####..
##.##..
##.##..
#####..
#.##..#
.###.##
.#.##..
.###.##
.##..##
#.#.###
.#.....
##.##..
.######
.#.####

####..#..#..###
..#.########.#.
####...##...###
...##########..
..#..........#.
###.########.##
..#..##..##..#.
##..#.####.#..#
##.#.##..##.#.#
###.###..###.##
####.##..##.###
..#....###...#.
..##.#....#.##.
##..##.##.##..#
...##########..
######.##.#####
###..........##

#.....#...#..#...
##.#...#..#..#..#
##.###.##########
##.##.###########
#.##...#.#.##.#.#
#.#..............
..##.....##..##..
##..#......##....
##.##.#.#.####.#.
##..#.#.#.####.#.
##..#......##....

......#.##.#...
#.##.#......#.#
......####.#...
.#..#.#....#.#.
##..###.##.###.
.#..#.#....#.#.
#....##....##..
.####..####..##
.####.#....#.##

#####.#.##.#.
...##...##.#.
...##...##.#.
#####.####.#.
####...#....#
####.....###.
##....###.##.
##...##...###
..###...##.#.
.....#.#.##..
...#.##......
####..#####..
###.#....##..
..######..###
....##...#..#

.##.###....####
#......#..#####
..#..#..#.##..#
#...##.####....
.###...####....
.###...####....
#...##.####....
..#..#..#.##..#
#.....##..#####

#..##..#.#.#..#
....#.#.##.##.#
....#.#.#.####.
####.#.....##.#
.##...#.#..###.
.##...#.#..###.
####.#.....##.#
....#.#.#.####.
....#.#.#..##.#
#..##..#.#.#..#
####.#...##.#.#
#####..#.###..#
.....#.#.#.##..
#..##.##.###.#.
#..#...##.#.#.#
....##.###.#..#
.##.###.....##.

.#..#.##.####..##
#..##..#.#.#...##
#...#.#.##.#.##.#
##..###....#.###.
.###...#.#.####.#
.###...#.#.####.#
##..##.....#.###.
#...#.#.##.#.##.#
#..##..#.#.#...##
.#..#.##.####..##
.#....###..##...#
#.#.######..#####
...#.#..##...####
.#.#####.....##..
##.#.#.##.###....
##.#.#.##.###....
.#.#####.....##..

.#..#.#.#.##.
##..##.#.....
#....#.#.####
#.##.#.#..##.
..##..#......
##..##.##.##.
#....#.#..##.
######..#####
..##....##..#
#.##.#..##..#
.........####
..##..#.##..#
.#..#..##....
....#...#####
##..##..#.##.
.####.####..#
##..##.######

#....#..#
###..#...
##.######
..##..#.#
..####.##
##...####
##.#..###
.....#.#.
..##...#.
...#.###.
####..###
......###
...#....#
#####.#.#
..#.#..#.
..#.#..#.
#####.#.#

#######...#....#.
###.#..##..#..#..
#.###.#..#..##..#
#.###.#..#..##..#
###.#..##..#..#..
#######...#....#.
#...#.#.##.####.#
..#.#.#.##.#..###
#.#...#.###....##
.######.....##...
#..#.#.##.##..##.
.##..#.##.#....#.
#.##..######..###
#...#.#..########
#.###.#..........

#..#..#..##..#..#
#.###############
####..##....##..#
##.####......####
..#####..##..####
#.##..#..##..#..#
###.####.##.####.
##.#..#......#..#
.###..#.#..#.#..#
.#.#..#..##..#..#
##.####......####
.##.##.#.##.#.##.
.######.####.####

#.#....#.
###..#..#
###..#..#
#.#....#.
.####..#.
..##..###
..#.#..#.
#..#..##.
.###.###.
...#..#..
...#....#
###.#.###
....#.#.#
##.#.##.#
##.####.#
#..####.#
##.#.##.#

......#
#####.#
......#
####.#.
.##...#
#..#.#.
.###.##
.....#.
.##....
.##....
.....#.

...###.#.....##..
#.######.#.......
#.##.###.#.......
...###.#.....##..
.#..##..#.###..##
#..###.####...###
#####.#...#.##...
#####.#..###.####
#########.#.#####
.#####....##..###
##.#..#..####..##"""
}